ped affection status 2 == affected, 1 = unaffected.
fbat recodes them by default to 1 and 0 respectively.

>> load test_data/test_check.ped
read in: 8 markers from 11 pedigrees (11 nuclear families,33 persons)
>> minsize 2
current minimum informative family count is 2
>> fbat
trait affection; offset 0.000; model additive; test bi-allelic; minsize 2; min_freq 0.000; p 1.000; maxcmh 1000

Marker  Allele   afreq   fam#     S-E(S)      Var(S)       Z           P
------------------------------------------------------------------------
m654    1        0.804      3      0.000       1.000   0.000    1.000000
m654    2        0.196      3      0.000       1.000   0.000    1.000000
m47     1        0.438      4      1.000       1.500   0.816    0.414216
m47     2        0.562      4     -1.000       1.500  -0.816    0.414216
p46     1        0.250      4     -1.000       1.500  -0.816    0.414216
p46     2        0.750      4      1.000       1.500   0.816    0.414216
p79     1        0.540      2     -0.500       0.750  -0.577    0.563703
p79     2        0.460      2      0.500       0.750   0.577    0.563703
p252    1        0.275      2      0.500       0.750   0.577    0.563703
p252    2        0.725      2     -0.500       0.750  -0.577    0.563703
p523    1        0.729      2     -0.500       0.750  -0.577    0.563703
p523    2        0.271      2      0.500       0.750   0.577    0.563703


FBAT object
Number of families: 11
Number of alleles: 66
Markers: ['m709', 'm654', 'm47', 'p46', 'p79', 'p252', 'p491', 'p523']
Marker	Allele	afreq	Nfams	S-E(S)	Var(S)	Z	P
m709	['0', '1']	0.969696969697	0	0.00	0.0	0	1	1
m654	['0', '1', '2']	0.742424242424	2	0.00	1.0	0	1	1
m47	['0', '1', '2']	0.454545454545	4	-1.00	1.5	-0.816496553711	1	1
p46	['0', '1', '2']	0.227272727273	5	1.00	1.5	0.816496553711	1	1
p79	['0', '1', '2']	0.469696969697	3	0.50	0.75	0.5773502307	1	1
p252	['0', '1', '2']	0.227272727273	2	-0.50	0.75	-0.5773502307	1	1
p491	['0', '1']	0.939393939394	0	0.00	0.0	0	1	1
p523	['0', '1', '2']	0.727272727273	2	0.50	0.75	0.5773502307	1	1

===========================================================================
  m654
===========================================================================

Marker  Allele   afreq   fam#     S-E(S)      Var(S)       Z           P
------------------------------------------------------------------------
m654    1        0.804      3      0.000       1.000   0.000    1.000000
m654    2        0.196      3      0.000       1.000   0.000    1.000000


In [96]: s.printTest()
m654	['0', '1', '2']	0.742424242424	3	-0.50	0.25	0	1	1



2	m654	0	118783	
p1  p2     c    t   x   xt   et  U   v(x^2)  e^2
1 1 1 1   1 1   0
1 1 2 1   1 1   0   
1 1 2 2   2 1   0
1 1 1 1   1 1   0
2 1 1 1   2 1   0
1 1 1 1   1 1   0
  
2 1 2 1   2 1   1   1   1   1    0    1.5     1
2 1 1 1   2 1   1   1   1   0.5  .5   0.5     0.25
1 1 0 0   1 1   1   0   0  (0)ok 0    ()      ()
2 1 0 0   1 1   1   0   0  (0)   0   (0)      (0)
1 1 2 1   1 1   1   0   0   0.5  -.5  0.5     0.25
                        2   2        2.5      2


===========================================================================
  p47
===========================================================================
                           
m47     1        0.432      5      0.500       1.750   0.378    0.705457
m47     2        0.568      5     -0.500       1.750  -0.378    0.705457

with no missing data:
m47     1        0.450      4      1.000       1.500   0.816    0.414216
m47     2        0.550      4     -1.000       1.500  -0.816    0.414216

data for m47

3	m47	0	228783	
1  1  1  2  1  2  
1  2  2  2  1  2  
1  2  2  2  1  2  
1  2  1  2  1  2  
1  2  1  2  1  2  
1  1  1  2  1  1  
                      xt   et    u    vx2    e2
1  2  2  2    1  2    1    1.5  -0.5   2.5   2.25  0.25
1  2  1  2    1  2    1    1     0     1.5   1     0.5
1  2  0  0    2  2    2   (2)   (2)   (4)   4     0          <--- 
1  2  1  2    1  1    0    1    -1     1.5   1     0.5
1  2  2  2    2  2    2    1.5   0.5   2.5   2.25  0.25
                      6    7    -0.5     12          1.5



===========================================================================
  p46
===========================================================================


p46     1        0.250      4     -1.000       1.500  -0.816    0.414216 *
p46     2        0.750      4      1.000       1.500   0.816    0.414216 *

In [15]: s.childidx
Out[15]: [[1], [2], [2], [1], [0], [0], [0], [0], [1], [0], [0]]

p46

4	p46	0	338783	
                     t   x   xt   e    u    vx2    e2
2  2  2  2    2  2   1   2   2    2    0     4     4
2  2  1  2    2  2   1   2   2    1.5  0.5   2.5
2  2  1  1    1  2   1   1   1    1    0     1
1  2  2  2    2  2   1   2   2    1.5  0.5   
2  2  2  2    2  2   1   2   2    2    0
2  2  2  2    2  2   1   2   2    2    0
                                       1

1  2  1  2    1  2   1   1   1   1     0
1  2  2  2    1  2   1   1   1   1.5   -0.5
1  2  0  0    1  2   1   1   1  (1)     0
1  2  1  2    2  2   1   2   2   1     1
2  2  1  2    2  2   1   2   2   1.5   0.5
                             6   5     1 
                               1


===========================================================================
  m79
===========================================================================

p79     1        0.540      2     -0.500       0.750  -0.577    0.563703 *
p79     2        0.460      2      0.500       0.750   0.577    0.563703 *


In [15]: s.childidx
Out[15]: [[1], [2], [2], [1], [0], [0], [0], [0], [1], [0], [0]]


5	p79	0	448783	

		        t  x  xt  e
2  2  2  1     2  1     1  1  1   1.5
2  1  1  1     2  1     1  1  1   0.5      check 2
2  1  1  1     2  1     1  1  1   0.5
2  1  2  1     2  1     1  1  1   1
0  0  2  1     2  1     1  1  1   (1)
2  1  2  2     2  2     1  2  2   1.5
                             (7)  (6)
                                1     fbat returns 1 ... must be inferring (1)

2  1  1  1     2  1     1  1  1   0.5   
2  1  2  1     2  1     1  1  1   1
2  1  0  0     1  1     1  0  0   (0)   check 1
2  1  0  0     2  2     1  2  2   (2)
0  0  1  1     1  1     1  0  0   (0)
                              4   3.5
                                0.5

===========================================================================
  p252
===========================================================================

 
test.tfam  (bottom 5)

p252    1        0.275      2      0.500       0.750   0.577    0.563703
p252    2        0.725      2     -0.500       0.750  -0.577    0.563703

p252	['0', '1', '2']	0.227272727273	3	-2.00	0.5	-4.0	1	1


6	p252	0	558783	

2 2 1 2   1 2 
1 2 1 2   0 0 
1 2 2 2   2 2 
2 2 1 2   1 2 
2 2 1 2   2 2 
1 2 2 2   2 2 
                x   e
2 2 1 2   0 0   0   0   
2 2 1 2   2 2   0   0.5  # if genotypes '1' and '2' were switched.  
0 0 0 0   0 0   0   0
2 2 2 2   2 2   0   0
1 2 1 2   1 1   2   1
                2   1.5
                    0.5

===========================================================================
  p523
===========================================================================
fbat reports
p523    1        0.729      2     -0.500       0.750  -0.577    0.563703 
p523    2        0.271      2      0.500       0.750   0.577    0.563703


8	p523	0	898783	

1  1  1  2  1  2  
1  2  1  2  1  2  
1  2  1  1  1  1  
1  1  1  2  1  2  
1  1  1  1  1  2  
1  1  1  2  1  1  
                    t   x   xt   e     U
1  1  1  2   1  1   1   0   0    0.5   -0.5
1  1  1  1   1  1   1   0   0    0     0
1  1  0  0   1  2   1   1   1    1     0
1  1  1  1   1  1   1   0   0    0     0
1  2  1  2   2  2   1   2   2    1     1
                                       0.5


In [15]: s.childidx
Out[15]: [[1], [2], [2], [1], [0], [0], [0], [0], [1], [0], [0]]



----------------------------------------------------------------------------------


# 1s on the upper 6 and 0s on the lower 5

>> load test_data/test_check2.ped
read in: 8 markers from 11 pedigrees (11 nuclear families,33 persons)
>> minsize 2
current minimum informative family count is 2
>> fbat
trait affection; offset 0.000; model additive; test bi-allelic; minsize 2; min_freq 0.000; p 1.000; maxcmh 1000

Marker  Allele   afreq   fam#     S-E(S)      Var(S)       Z           P
------------------------------------------------------------------------
m654    1        0.804      2      0.000       0.500   0.000    1.000000
m654    2        0.196      2      0.000       0.500   0.000    1.000000
m47     1        0.432      6      1.000       2.000   0.707    0.479500
m47     2        0.568      6     -1.000       2.000  -0.707    0.479500
p46     1        0.250      2     -1.000       0.500  -1.414    0.157299
p46     2        0.750      2      1.000       0.500   1.414    0.157299
p79     1        0.540      5     -1.000       1.500  -0.816    0.414216
p79     2        0.460      5      1.000       1.500   0.816    0.414216
p252    1        0.275      5     -0.500       1.250  -0.447    0.654721
p252    2        0.725      5      0.500       1.250   0.447    0.654721
p523    1        0.729      6      0.500       1.750   0.378    0.705457
p523    2        0.271      6     -0.500       1.750  -0.378    0.705457

FBAT object
Number of families: 11
Number of alleles: 66
Markers: ['m709', 'm654', 'm47', 'p46', 'p79', 'p252', 'p491', 'p523']
Marker	Allele	afreq	Nfams	S-E(S)	Var(S)	Z	P
m709	['0', '1']	0.969696969697	0	0.00	0.0	0	1	1
m654	['0', '1', '2']	0.742424242424	2	0.00	0.5	0	1	1
m47	['0', '1', '2']	0.454545454545	5	-1.00	2.0	-0.707106763509	1	1
p46	['0', '1', '2']	0.227272727273	6	1.00	0.5	1.41421342095	1	1
p79	['0', '1', '2']	0.469696969697	6	1.00	1.5	0.816496553711	1	1
p252	['0', '1', '2']	0.227272727273	5	0.50	1.25	0.447213577611	1	1
p491	['0', '1']	0.939393939394	0	0.00	0.0	0	1	1
p523	['0', '1', '2']	0.727272727273	3	-0.50	1.75	-0.37796446221	1	1


======================================================================================================

>> load test_data/test_check.ped
read in: 8 markers from 11 pedigrees (11 nuclear families,33 persons)
>> minsize 2
current minimum informative family count is 2
>> offset 0.5
current trait offset is 0.500000
>> fbat
trait affection; offset 0.500; model additive; test bi-allelic; minsize 2; min_freq 0.000; p 1.000; maxcmh 1000

Marker  Allele   afreq   fam#     S-E(S)      Var(S)       Z           P
------------------------------------------------------------------------
m654    1        0.804      5      0.000       0.375   0.000    1.000000
m654    2        0.196      5      0.000       0.375   0.000    1.000000
m47     1        0.438     10      0.000       0.875   0.000    1.000000
m47     2        0.562     10      0.000       0.875   0.000    1.000000
p46     1        0.250      6      0.000       0.500   0.000    1.000000
p46     2        0.750      6      0.000       0.500   0.000    1.000000
p79     1        0.540      7      0.250       0.562   0.333    0.738883
p79     2        0.460      7     -0.250       0.562  -0.333    0.738883
p252    1        0.275      7      0.500       0.500   0.707    0.479500
p252    2        0.725      7     -0.500       0.500  -0.707    0.479500
p523    1        0.729      8     -0.500       0.625  -0.632    0.527089
p523    2        0.271      8      0.500       0.625   0.632    0.527089

FBAT object
Number of families: 11
Number of alleles: 66
Markers: ['m709', 'm654', 'm47', 'p46', 'p79', 'p252', 'p491', 'p523']
Marker	Allele	afreq	Nfams	S-E(S)	Var(S)	Z	P
m709	['0', '1']	0.969696969697	0	0.00	0.0	0	1	1
m654	['0', '1', '2']	0.742424242424	4	0.00	0.375	0	1	1
m47	['0', '1', '2']	0.454545454545	9	0.00	0.875	0	1	1
p46	['0', '1', '2']	0.227272727273	11	0.00	0.5	0	1	1
p79	['0', '1', '2']	0.469696969697	9	-0.250	0.5625	-0.333333303704	1	1
p252	['0', '1', '2']	0.227272727273	7	-0.50	0.5	-0.707106710476	1	1
p491	['0', '1']	0.939393939394	0	0.00	0.0	0	1	1
p523	['0', '1', '2']	0.727272727273	5	0.50	0.625	0.632455481437	1	1

FBAT object
Number of families: 11
Number of alleles: 66
Markers: ['m709', 'm654', 'm47', 'p46', 'p79', 'p252', 'p491', 'p523']
Marker	Allele	afreq	Nfams	S-E(S)	Var(S)	Z	P
m709	['0', '1']	0.969696969697	0	0.00	0.0	0	1	1
m654	['0', '1', '2']	0.742424242424	4	0.00	0.375	0	1	1
m47	['0', '1', '2']	0.454545454545	9	0.00	0.875	0	1	1
p46	['0', '1', '2']	0.227272727273	11	0.00	0.5	0	1	1
p79	['0', '1', '2']	0.469696969697	9	0.250	0.5625	0.333333303704	1	1
p252	['0', '1', '2']	0.227272727273	7	0.50	0.5	0.707106710476	1	1
p491	['0', '1']	0.939393939394	0	0.00	0.0	0	1	1
p523	['0', '1', '2']	0.727272727273	5	-0.50	0.625	-0.632455481437	1	1


===========================================================================
  m654
===========================================================================

Marker  Allele   afreq   fam#     S-E(S)      Var(S)       Z           P
------------------------------------------------------------------------
m654    1        0.804      5      0.000       0.375   0.000    1.000000
m654    2        0.196      5      0.000       0.375   0.000    1.000000

m654	['0', '1', '2']	0.742424242424	2	0.00	0.5	0	1	1


2	m654	0	118783	
p1  p2     c    t   x   xt   e    v(x^2)  e^2    V      Vt^2
1 1 1 1   1 1   -   0   0    0     0      0      0       
1 1 2 1   1 1   -   0   0    0.5   0.5    0.25   0.25   0.0625
1 1 2 2   2 1   -   1  -0.5  1     1      1      0
1 1 1 1   1 1   -   0   0    0     0      0      0
2 1 1 1   2 1   -   1  -0.5  0.5   0.5    0.25   0.25   0.0625
1 1 1 1   1 1   -   0   0    0     0      0      0
  
2 1 2 1   2 1   +   1   0.5  1     1.5    1      0.5    0.125
2 1 1 1   2 1   +   1   0.5  0.5   0.5    0.25   0.25   0.0625 
1 1 0 0   1 1   +   0   0    0     0      0      0
2 1 0 0   1 1   +   0   0    0     0      0      0
1 1 2 1   1 1   +   0   0    0.5   0.5    0.25   0.25   0.0625
                       (0)   (0)                        0.375
                       

